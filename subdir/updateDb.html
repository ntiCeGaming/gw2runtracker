<!DOCTYPE html><html lang=en><meta charset=UTF-8><meta name=viewport content="width=device-width, initial-scale=1.0"><title>Update Database</title><style>body{max-width:800px;margin:0 auto;padding:20px;font-family:Arial,sans-serif}#results{white-space:pre-wrap;background-color:#f5f5f5;border-radius:5px;margin-top:20px;padding:15px;font-family:monospace}button{color:#fff;cursor:pointer;background-color:#2c87c0;border:none;border-radius:4px;margin-bottom:10px;margin-right:10px;padding:10px 20px;font-size:16px}button:hover{background-color:#236d9b}.success{color:green;font-weight:700}.error{color:red;font-weight:700}</style><body>
  <h1>Update Raid Tracker Database</h1>
  <p>This page allows you to check and update the database to ensure Wing 8 is properly included.</p>
  
  <button id=checkBtn>Check Database</button>
  <button id=updateBtn>Add/Update Wing 8</button>
  <button id=backBtn>Back to App</button>
  
  <div id=results></div>
  
  <script>let resultsDiv=document.getElementById("results");function log(e,n="info"){console.log(e);let r="object"==typeof e?JSON.stringify(e,null,2):e;resultsDiv.innerHTML+=`<div class="${"error"===n?"error":"success"===n?"success":""}">${r}</div>`}function checkDatabase(){resultsDiv.innerHTML="",log("Checking database...");let e=indexedDB.open("RaidTrackerDatabase",1);e.onerror=function(e){log("Database error: "+e.target.error,"error")},e.onsuccess=function(e){let n=e.target.result;if(log("Database opened successfully"),!n.objectStoreNames.contains("raidWings"))return void log("raidWings object store not found","error");let r=n.transaction(["raidWings"],"readonly").objectStore("raidWings").getAll();r.onsuccess=function(){let e=r.result;log("All raid wings:"),e.forEach(e=>{log(`ID: ${e.id||"N/A"}, Name: ${e.name}, Bosses: ${e.bosses?e.bosses.join(", "):"None"}`)});let n=e.find(e=>e.name.includes("Wing 8"));n?(log("Wing 8 found:","success"),log(n)):log("Wing 8 not found in the database","error")},r.onerror=function(e){log("Error getting raid wings: "+e.target.error,"error")}}}function updateDatabase(){resultsDiv.innerHTML="",log("Updating database...");let e=indexedDB.open("RaidTrackerDatabase",1);e.onerror=function(e){log("Database error: "+e.target.error,"error")},e.onsuccess=function(e){let n=e.target.result;if(log("Database opened successfully"),!n.objectStoreNames.contains("raidWings"))return void log("raidWings object store not found","error");let r=n.transaction(["raidWings"],"readwrite"),o=r.objectStore("raidWings"),t=o.getAll();t.onsuccess=function(){let e=t.result;log("Found "+e.length+" raid wings");let n=e.findIndex(e=>e.name.includes("Wing 8"));if(-1!==n){let r=e[n];log("Found Wing 8:","success"),log(r);let t={...r,name:"Mount Balrior (Wing 8)",description:"The eighth raid wing, featuring Greer, Decima, and Ura.",bosses:["Greer","Decima","Ura"]},s=o.put(t);s.onsuccess=function(){log("Wing 8 updated successfully","success")},s.onerror=function(e){log("Error updating Wing 8: "+e.target.error,"error")}}else{log("Wing 8 not found in the database, adding it now...","info");let n=8;e.length>0&&(n=Math.max(...e.map(e=>e.id||0))+1);let r={id:n,name:"Mount Balrior (Wing 8)",description:"The eighth raid wing, featuring Greer, Decima, and Ura.",bosses:["Greer","Decima","Ura"],imageUrl:"https://wiki.guildwars2.com/images/thumb/5/5f/Dragonstorm_loading_screen.jpg/300px-Dragonstorm_loading_screen.jpg"};log("Adding new Wing 8:","info"),log(r);let t=o.add(r);t.onsuccess=function(){log("Wing 8 added successfully","success")},t.onerror=function(e){log("Error adding Wing 8: "+e.target.error,"error")}}},t.onerror=function(e){log("Error getting raid wings: "+e.target.error,"error")},r.oncomplete=function(){log("Transaction completed successfully","success"),log("Please refresh the main application to see the changes.")}}}document.getElementById("checkBtn").addEventListener("click",checkDatabase),document.getElementById("updateBtn").addEventListener("click",updateDatabase),document.getElementById("backBtn").addEventListener("click",function(){window.location.href=window.location.pathname.substring(0,window.location.pathname.lastIndexOf("/"))||"."});</script>

